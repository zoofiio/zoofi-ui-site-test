(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6161],{16299:function(e,t,n){Promise.resolve().then(n.bind(n,71080))},71080:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return TesterPage}});var r=n(31113),a=n(99548),i=n(26504),s=n(19757),o=n(59175),c=n(15506),u=n(84944),l=n(33501),d=n(64103),f=n(45631),p=n(58409),m=n(33737);function TesterPage(){let e=(0,o.p)(),t=s.iK[e],[{value:n,feed:v},h]=(0,p.Z)({value:"",feed:t[0].assetTokenFeed}),x=(0,d.useMemo)(()=>t.map(e=>({label:e.assetTokenSymbol+e.version,value:e.assetTokenFeed})),[]),{data:b}=(0,c.D2)({abi:i.nq,address:v,functionName:"latestPrice"}),g=b||0n;return(0,r.jsx)("div",{className:"w-full flex",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 w-full max-w-[840px] mx-auto px-5",children:[(0,r.jsx)(f.ZP,{defaultValue:x[0],options:x,onChange:e=>h({feed:null==e?void 0:e.value})}),(0,r.jsx)("input",{value:n.toString(),onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");h({value:t})},type:"number",className:(0,l.Z)("bg-white border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-2xl border focus:border-2 text-slate-700 rounded-md outline-none"),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,r.jsxs)("div",{children:["Price: ",(0,u.Rp)(g,2,8)]}),(0,r.jsx)(a.v,{tx:"Update",config:{abi:i.Og,address:v,functionName:"mockPrice",args:[(0,m.v)(n,8)]},onTxSuccess:()=>{h({value:""})},className:"btn-primary flex items-center justify-center gap-4"})]})})}},99548:function(e,t,n){"use strict";n.d(t,{v:function(){return ApproveAndTx}});var r=n(31113),a=n(19757),i=n(26361),s=n(64103),o=n(47259),c=n(58714),u=n(41440),l=n(41774),d=n(48914);let f={},useApproves=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:r,chainId:p}=(0,u.m)(),m=(0,l.t)(),{data:v}=(0,d.p)(),[h,x]=(0,s.useState)(!1),b=(0,s.useMemo)(()=>Object.keys(e).filter(e=>e!==a.K8),[e]),[g,w]=(0,s.useState)(t&&f[t]||{}),updateAllownce=(e,n)=>{t&&(f[t]={...f[t]||{},[e]:n},w(t=>({...t,[e]:n})))},y=(0,l.t)();(0,s.useEffect)(()=>{r&&t&&m&&p&&b.forEach(e=>{m.readContract({abi:c.Wo,address:e,functionName:"allowance",args:[r,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,p,r]);let[N,A]=(0,s.useState)(!1),j=(0,s.useMemo)(()=>b.filter(t=>(0,i.ok)(e,t)>0n&&(0,i.ok)(e,t)>(0,i.ok)(g,t)),[e,b,g]),approve=async()=>{if(0!=j.length&&t)try{A(!0),x(!1);for(let r=0;r<j.length;r++){let a=j[r],i=!1===n?e[a]:n,s=await (null==v?void 0:v.writeContract({abi:c.Wo,address:a,functionName:"approve",args:[t,i]}));s&&await (null==y?void 0:y.waitForTransactionReceipt({hash:s})),updateAllownce(a,i)}o.A.success("Approve success"),A(!1),x(!0)}catch(e){o.A.error((0,i.az)(e)),A(!1),x(!1)}};return{approve,loading:N,shouldApprove:j.length>0,isSuccess:h}};var p=n(78354),m=n(88501),v=n(36762);function ApproveAndTx(e){let{className:t,tx:n,approves:a,spender:i,requestAmount:o,config:c,toast:u=!0,disabled:l,onTxSuccess:d,onApproveSuccess:f}=e,{write:h,isDisabled:x,isLoading:b}=(0,p.R)(c,{onSuccess:()=>d&&d(),autoToast:u}),g=l||x||b||!1===c.enabled,{approve:w,shouldApprove:y,loading:N,isSuccess:A}=useApproves(a||{},i,o),j=(0,s.useRef)();return(j.current=f,(0,s.useEffect)(()=>{j.current&&A&&j.current()},[A]),y)?(0,r.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:w,disabled:l||!w||N,children:[N&&(0,r.jsx)(v.$,{}),"Approve"]}):(0,r.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:()=>h(),disabled:g,children:[b&&(0,r.jsx)(v.$,{}),n]})}},36762:function(e,t,n){"use strict";n.d(t,{$:function(){return Spinner}});var r=n(31113),a=n(33501);let Spinner=e=>{let{className:t}=e;return(0,r.jsxs)("svg",{fill:"none",className:(0,a.Z)(t,"animate-spin h-5 w-5 2-ml-1 2mr-3"),viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},78354:function(e,t,n){"use strict";n.d(t,{R:function(){return useWrapContractWrite}});var r=n(26361),a=n(64103),i=n(47259),s=n(41774),o=n(48914),c=n(15506);function useWrapContractWrite(e,t){let{autoToast:n=!0,onSuccess:u}=t||{},[l,d]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!1),m=(0,s.t)(),{data:v}=(0,o.p)(),h=!m||!v||!v.account||l||!e,x=(0,c.hp)(),write=async()=>{if(!h){d(!0),p(!1);try{let t="function"==typeof e?await e():e,{request:r}=await m.simulateContract({account:v.account,...t}),a=await v.writeContract(r),s=await m.waitForTransactionReceipt({hash:a});if("success"!==s.status)throw"Transaction reverted";p(!0),u&&u(),n&&i.A.success("Transaction success"),x.update()}catch(e){n&&i.A.error((0,r.az)(e))}d(!1)}};return{write,isDisabled:h,isLoading:l,isSuccess:f}}},84944:function(e,t,n){"use strict";n.d(t,{Rp:function(){return displayBalanceWithUnit},ZM:function(){return displayBalanceWithoutFormat},dq:function(){return displayBalance}});var r=n(35057),a=n(11292);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2?arguments[2]:void 0;if(!e)return"0";let a=10**t,i=Math.floor(Number((0,r.b)(e,n))*a)/a,s=Number((.1**t).toFixed(t));return i>0&&i<s?"<"+s:i<0&&i>-s?"≈0":i.toLocaleString("en-US",{maximumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return"0";let r=Number((0,a.d)(e)),i=Number((.1**t).toFixed(t));return r>0&&r<i?"<"+i:r<0&&r>-i?"≈0":r.toLocaleString("en-US",{...n||{},maximumFractionDigits:t})},displayBalanceWithoutFormat=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0";let n=10**t,r=Math.floor(Number((0,a.d)(e))*n)/n,i=Number((.1**t).toFixed(t));return r>0&&r<i?"<"+i:r<0&&r>-i?"≈0":String(r)}},58409:function(e,t,n){"use strict";var r=n(64103);t.Z=function(e){void 0===e&&(e={});var t=(0,r.useState)(e),n=t[0],a=t[1];return[n,(0,r.useCallback)(function(e){a(function(t){return Object.assign({},t,e instanceof Function?e(t):e)})},[])]}}},function(e){e.O(0,[7495,4431,8410,5631,1578,7093,604,1744],function(){return e(e.s=16299)}),_N_E=e.O()}]);