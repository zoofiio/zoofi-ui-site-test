(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{32004:function(e,t,a){Promise.resolve().then(a.bind(a,10219))},10219:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return AdminPage}});var n=a(31113),r=a(99548),s=a(88702),l=a(44939),i=a(70258),o=a(19757),u=a(59175),c=a(48405),d=a(15506),p=a(26361),f=a(64103),m=a(45631),v=a(58409),x=a(85665),b=a(62531),g=a(35057),h=a(33737),y=a(11292),j=a(96670);let A=[{label:"资产利息率",value:"Y"},{label:"目标AAR",value:"AART"},{label:"安全AAR",value:"AARS"},{label:"上顶AAR",value:"AARU"},{label:"熔断AAR",value:"AARC"},{label:"赎回手续费",value:"C"},{label:"进入国库比例",value:"TreasuryFeeRate"},{label:"Discount冷静时间",value:"CircuitBreakPeriod",units:0},{label:"低买池最小成交量USB",value:"PtyPoolMinUsbAmount"},{label:"高卖池最小成交量",value:"PtyPoolMinAssetAmount"},{label:"RateR",value:"RateR"}],w=[{label:"产品周期",value:"D",units:0},{label:"初始定价",value:"APRi"},{label:"赎回手续费",value:"f1"},{label:"利息佣金",value:"f2"}];function UpdateVaultParams(e){let{paramList:t,vault:a,protocoSettingAddress:l}=e,o=(0,f.useMemo)(()=>t.map(e=>({...e,label:"".concat(e.label,"(").concat(e.value,")")})),[t]),[{value:u,param:c},y]=(0,v.Z)({value:"",param:o[0]}),{data:j,refetch:A}=(0,d.uX)({contracts:t.map(e=>({abi:i.$4,address:l,functionName:"vaultParamValue",args:[a,(0,b.$G)(e.value,{size:32})]}))}),w=(0,f.useMemo)(()=>(j||[]).map((e,a)=>{let n=t[a];return"".concat(n.label,"(").concat(n.value,"): ").concat((0,g.b)(e.result||0n,"number"==typeof n.units?n.units:10))}),[j]),N="number"==typeof c.units?c.units:10,[k,C]=(0,x.Z)();return(0,n.jsxs)(s.Ak,{tit:"Vault Param Vaule",children:[(0,n.jsx)(m.ZP,{classNames:s.At,maxMenuHeight:C.height+110,value:c,options:o,onChange:e=>y({param:e})}),(0,n.jsx)("input",{value:u.toString(),onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");y({value:t})},type:"number",className:(0,p.cn)(s.pk),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,n.jsx)(r.v,{tx:"Write",config:{abi:i.$4,address:l,functionName:"updateVaultParamValue",args:[a,(0,b.$G)(c.value,{size:32}),(0,h.v)(u,N)]},onTxSuccess:()=>{y({value:""}),A()},className:"btn-primary w-full flex items-center justify-center gap-4"}),(0,n.jsx)("div",{className:"text-sm flex flex-col items-start",ref:k,children:w.map((e,t)=>(0,n.jsx)("div",{children:e},"info_".concat(t)))})]})}function UpdateVaultPrice(e){let{vc:t}=e,[{feed:a},l]=(0,v.Z)({feed:""});return(0,n.jsxs)(s.Ak,{tit:"Vault Price Feed",children:[(0,n.jsx)("input",{type:"text",placeholder:"_assetTokenPriceFeed_",value:a,onChange:e=>l({feed:e.target.value}),className:(0,p.cn)(s.pk)}),(0,n.jsx)(r.v,{tx:"Write",config:{abi:i.WW,address:t.vault,functionName:"updatePriceFeed",args:[a]},onTxSuccess:()=>{l({feed:""})},className:"btn-primary w-full flex items-center justify-center gap-4"})]})}function ClaimYieldsForBuyPool(e){let{vc:t}=e,{data:a}=(0,d.D2)({abi:i.aT,address:t.ptyPoolBelowAddress,functionName:"claimableYields"}),l=t.ptyPoolBelowAddress&&a||0n,[{address:o},u]=(0,v.Z)({address:""});return(0,n.jsxs)(s.Ak,{tit:"ClaimYields for Buy Low Pool",children:[(0,n.jsxs)("span",{children:["Yields: ",(0,y.d)(l)]}),(0,n.jsx)("input",{type:"text",placeholder:"recipient",value:o,onChange:e=>u({address:e.target.value}),className:(0,p.cn)(s.pk)}),(0,n.jsx)(r.v,{tx:"Write",disabled:!t.ptyPoolBelowAddress||l<=0n,config:{abi:i.aT,address:t.ptyPoolBelowAddress,functionName:"claimYields",args:[o]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}function SetTester(e){let{vc:t}=e,{data:a}=(0,d.D2)({abi:i.Og,address:t.assetTokenFeed,functionName:"getTestersCount"}),{data:l}=(0,d.D2)({abi:i.Og,address:t.assetTokenFeed,functionName:"owner"}),o=a||0n,{data:u}=(0,d.uX)({contracts:Array.from(Array(parseInt(o.toString()))).map((e,a)=>({abi:i.Og,address:t.assetTokenFeed,functionName:"getTester",args:[BigInt(a)]}))}),c=(null==u?void 0:u.map(e=>e.result))||[],[{address:f},m]=(0,v.Z)({address:""});return(0,n.jsxs)(s.Ak,{tit:"Set tester",children:[(0,n.jsxs)("div",{children:["Owner: ",l]}),(0,n.jsxs)("div",{children:["Tester Count: ",o.toString()]}),(0,n.jsx)("div",{children:"Testers"}),c.map(e=>(0,n.jsx)("div",{children:e},e)),(0,n.jsx)("input",{type:"text",placeholder:"recipient",value:f,onChange:e=>m({address:e.target.value}),className:(0,p.cn)(s.pk)}),(0,n.jsx)(r.v,{tx:"Write",disabled:!f,config:{abi:i.Og,address:t.assetTokenFeed,functionName:"setTester",args:[f,!0]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}let N=[{label:"赎回手续费",value:"C"}];function AdminPage(){let e=(0,u.p)(),{current:t,setState:a,options:r}=(0,c.G)(),{chain:d}=(0,j.m)();return(0,n.jsx)(l.E,{children:(0,n.jsx)("div",{className:"w-full flex",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4 w-full max-w-[840px] mx-auto px-5",children:[(0,n.jsx)(m.ZP,{classNames:s.At,defaultValue:r[0],options:r,onChange:e=>e&&a({current:e})}),"L-Vault"==t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(UpdateVaultParams,{vault:t.data.vault,paramList:A,protocoSettingAddress:o.e_[e]}),(0,n.jsx)(UpdateVaultPrice,{vc:t.data}),["pauseMint","unpauseMint","pauseRedeem","unpauseRedeem","pauseUsbToMarginTokens","unpauseUsbToMarginTokens"].map(e=>(0,n.jsx)(s.UT,{functionName:e,abi:i.WW,address:t.data.vault},"l-vault-".concat(e))),(0,n.jsx)(s.UT,{abi:i.EF,functionName:"transferOwnership",address:o.Vq[e]}),(0,n.jsx)(ClaimYieldsForBuyPool,{vc:t.data}),(null==d?void 0:d.testnet)&&(0,n.jsx)(SetTester,{vc:t.data})]}),"P-Vault"==t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(UpdateVaultParams,{vault:t.data.vault,paramList:N,protocoSettingAddress:o.e_[e]}),["configureBlastYieldsAndGas","configureBlastPoints"].map(e=>(0,n.jsx)(s.UT,{abi:i.a4,functionName:e,address:t.data.vault},"p-vault-".concat(e)))]}),"B-Vault"==t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(UpdateVaultParams,{vault:t.data.vault,paramList:w,protocoSettingAddress:t.data.protocolSettingsAddress}),["close","pause","unpause","pauseRedeemPool","unpauseRedeemPool","addBribeToken","addBribes","setBriber"].map(e=>(0,n.jsx)(s.UT,{abi:i.j5,functionName:e,address:t.data.vault},"b-vault-".concat(e))),(0,n.jsx)(s.UT,{tit:"transferOwnership",abi:i.RR,functionName:"transferOwnership",address:t.data.protocolAddress}),(0,n.jsx)(s.UT,{tit:"upsertParamConfig",abi:i.$4,functionName:"upsertParamConfig",address:t.data.protocolSettingsAddress})]})]})})})}},99548:function(e,t,a){"use strict";a.d(t,{v:function(){return ApproveAndTx}});var n=a(31113),r=a(19757),s=a(26361),l=a(78403),i=a(64103),o=a(47259),u=a(58714),c=a(96670),d=a(4408);let p={},useApproves=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:n,chainId:f}=(0,c.m)(),{data:m}=(0,d.p)(),[v,x]=(0,i.useState)(!1),b=(0,i.useMemo)(()=>Object.keys(e).filter(e=>e!==r.K8),[e]),[g,h]=(0,i.useState)(t&&p[t]||{}),updateAllownce=(e,a)=>{t&&(p[t]={...p[t]||{},[e]:a},h(t=>({...t,[e]:a})))};(0,i.useEffect)(()=>{n&&t&&f&&b.forEach(e=>{(0,l.B)().readContract({abi:u.Wo,address:e,functionName:"allowance",args:[n,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,f,n]);let[y,j]=(0,i.useState)(!1),A=(0,i.useMemo)(()=>b.filter(t=>(0,s.ok)(e,t)>0n&&(0,s.ok)(e,t)>(0,s.ok)(g,t)),[e,b,g]),approve=async()=>{if(0!=A.length&&t)try{j(!0),x(!1);for(let n=0;n<A.length;n++){let r=A[n],s=!1===a?e[r]:a,i=await (null==m?void 0:m.writeContract({abi:u.Wo,address:r,functionName:"approve",args:[t,s]}));i&&await (0,l.B)().waitForTransactionReceipt({hash:i}),updateAllownce(r,s)}o.A.success("Approve success"),j(!1),x(!0)}catch(e){o.A.error((0,s.az)(e)),j(!1),x(!1)}};return{approve,loading:y,shouldApprove:A.length>0,isSuccess:v}};var f=a(78354),m=a(88501),v=a(36762);function ApproveAndTx(e){let{className:t,txType:a="btn-primary",tx:r,busyShowTxet:s=!0,approves:l,spender:o,requestAmount:u,config:c,toast:d=!0,skipSimulate:p=!1,disabled:x,onTxSuccess:b,onApproveSuccess:g}=e,{write:h,isDisabled:y,isLoading:j}=(0,f.R)(c,{onSuccess:()=>b&&b(),autoToast:d,skipSimulate:p}),A=x||y||j||!1===c.enabled,{approve:w,shouldApprove:N,loading:k,isSuccess:C}=useApproves(l||{},o,u),T=(0,i.useRef)();return(T.current=g,(0,i.useEffect)(()=>{T.current&&C&&T.current()},[C]),N)?(0,n.jsxs)("button",{className:(0,m.m)(a,"flex items-center justify-center gap-4",t),onClick:w,disabled:x||!w||k,children:[k&&(0,n.jsx)(v.$,{}),"Approve"]}):(0,n.jsxs)("button",{className:(0,m.m)(a,"flex items-center justify-center gap-4",t),onClick:()=>h(),disabled:A,children:[j&&(0,n.jsx)(v.$,{}),(s||!j)&&r]})}},88702:function(e,t,a){"use strict";a.d(t,{Ak:function(){return Expandable},At:function(){return d},UT:function(){return GeneralAction},pk:function(){return p}});var n=a(31113),r=a(62531),s=a(99548),l=a(26361),i=a(64103),o=a(83960),u=a(23125),c=a(58409);let d={menu:()=>(0,l.cn)("bg-white dark:bg-black dark:border"),option:e=>(0,l.cn)({"!bg-primary/50":e.isFocused,"!bg-primary":e.isSelected}),control:()=>"bg-white dark:bg-black !min-h-[58px] !border-primary/70 !shadow-none",singleValue:()=>"dark:text-white"},p="bg-white dark:bg-transparent border-primary/70 w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none ",defConvertArg=(e,t,a)=>a.type.startsWith("uint")?BigInt(e):"bytes32"==a.type?(0,r.$G)(e,{size:32}):"bool"==a.type?"true"==e:e,convertArgs=(e,t,a)=>e.map((e,n)=>{let r=t[n];return a?a(e,n,r):defConvertArg(e,n,r)});function Expandable(e){let{children:t,tit:a,disable:r}=e,[s,l]=(0,i.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col w-full bg-white dark:bg-transparent rounded-lg overflow-hidden border border-solid border-primary/40",children:[(0,n.jsxs)("div",{className:"px-5 py-2 min-h-[58px] flex justify-between items-center text-sm",children:[(0,n.jsx)("div",{className:"font-medium text-base",children:a}),r?t:(0,n.jsxs)("div",{className:"px-2 py-1 rounded-full border border-solid border-primary flex items-center text-xs text-primary cursor-pointer ",onClick:()=>l(!s),children:[(0,n.jsx)("span",{className:"mr-[5px]",children:s?"Close":"Expand"}),s?(0,n.jsx)(o.iRh,{}):(0,n.jsx)(o.tv1,{})]})]}),(0,n.jsx)(u.Collapse,{isOpened:s,theme:{content:"bg-gray-200 dark:bg-transparent p-4 flex flex-col gap-2"},children:t})]})}function GeneralAction(e){var t,a;let{abi:r,address:o,functionName:u,tit:d,infos:f,convertArg:m,txProps:v,onArgs:x}=e,b=r.find(e=>"function"==e.type&&e.name==u),[{args:g},h]=(0,c.Z)({args:Array((null==b?void 0:null===(t=b.inputs)||void 0===t?void 0:t.length)||0).fill("")});if((0,i.useEffect)(()=>{x&&x(g)},[g]),!b)return;let y=!b.inputs||0==b.inputs.length;return(0,n.jsxs)(Expandable,{tit:d||u,disable:y,children:[null===(a=b.inputs)||void 0===a?void 0:a.map((e,t)=>(0,n.jsx)("input",{type:"text",placeholder:e.name,value:g[t],onChange:e=>h({args:g.map((a,n)=>t==n?e.target.value:a)}),className:(0,l.cn)(p)},"input_".concat(t))),f,(0,n.jsx)(s.v,{...v||{},tx:"Write",config:{abi:r,address:o,functionName:u,...g.length?{args:convertArgs(g,b.inputs,m)}:{}},className:(0,l.cn)("!mt-0 btn-primary flex items-center justify-center gap-4",y?"max-w-[100px]":"w-full")})]})}},44939:function(e,t,a){"use strict";a.d(t,{E:function(){return PageWrap}});var n=a(31113);a(64103);var r=a(26361),s=a(69708),l=a(12045);function PageWrap(e){let{children:t,className:a}=e,i=(0,l.l)(e=>e.theme),o=(0,s.usePathname)();return(0,n.jsx)("div",{className:(0,r.cn)("min-h-[calc(100vh+1px)] h-auto pt-[90px] pb-6",a),style:{backgroundSize:"contain",background:"light"==i?"#eeeeee":"/"==o?"url(bg_home.svg) center bottom no-repeat,linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)":"linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)"},children:t})}},36762:function(e,t,a){"use strict";a.d(t,{$:function(){return Spinner}});var n=a(31113),r=a(26361);let Spinner=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{fill:"none",className:(0,r.cn)("animate-spin h-5 w-5 2-ml-1 2mr-3",t),viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},48405:function(e,t,a){"use strict";a.d(t,{G:function(){return useVaultsConfigs}});var n=a(87031),r=a(19757),s=a(22139),l=a(64103),i=a(58409),o=a(59175);function useVaultsConfigs(){let e=(0,o.p)(),t=r.iK[e]||[],a=r.VQ[e]||[],u=(0,l.useMemo)(()=>(n.Fw[e]||[]).filter(e=>e.onEnv&&e.onEnv.includes(s.Vi)),[e]),c=(0,l.useMemo)(()=>{let e=t.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"L-Vault"})),n=a.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"P-Vault"})),r=u.map(e=>({label:e.assetSymbol,value:e.vault,data:e,type:"B-Vault"}));return[...e,...n,...r].map(e=>({...e,label:"".concat(e.label,"(").concat(e.type,")")}))},[t,a,u]),[{current:d},p]=(0,i.Z)({current:c[0]});return{current:d,setState:p,options:c}}},15506:function(e,t,a){"use strict";a.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),a(78403);var n=a(83978),r=a.n(n);a(64103);var s=a(30308),l=a(59307),i=a(93108);let o=(0,i.Ue)(e=>({time:r().now(),update:()=>{e({time:r().now()})}}));function useWandContractRead(e){let{time:t}=o();return(0,s.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=o();return(0,l.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},78354:function(e,t,a){"use strict";a.d(t,{R:function(){return useWrapContractWrite}});var n=a(26361),r=a(78403),s=a(64103),l=a(47259),i=a(4408);function useWrapContractWrite(e,t){let{autoToast:a=!0,onSuccess:o}=t||{},[u,c]=(0,s.useState)(!1),[d,p]=(0,s.useState)(!1),{data:f}=(0,i.p)(),m=!f||!f.account||u||!e,write=async()=>{if(!m){c(!0),p(!1);try{let n="function"==typeof e?await e():e,s=(0,r.B)(),i={account:f.account,...n};if(!(null==t?void 0:t.skipSimulate)){let e=await s.simulateContract(i);i=e.request}let u=await f.writeContract(i),c=await s.waitForTransactionReceipt({hash:u});if("success"!==c.status)throw"Transaction reverted";p(!0),o&&o(),a&&l.A.success("Transaction success")}catch(e){a&&l.A.error((0,n.az)(e))}c(!1)}};return{write,isDisabled:m,isLoading:u,isSuccess:d}}},17695:function(e,t,a){"use strict";a.d(t,{S1:function(){return off},ZT:function(){return noop},jU:function(){return n},on:function(){return on}});var noop=function(){};function on(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e&&e.addEventListener&&e.addEventListener.apply(e,t)}function off(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}var n="undefined"!=typeof window},85665:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(64103),r=a(17695),s=r.jU?n.useLayoutEffect:n.useEffect,l={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0},i=r.jU&&void 0!==window.ResizeObserver?function(){var e=(0,n.useState)(null),t=e[0],a=e[1],r=(0,n.useState)(l),i=r[0],o=r[1],u=(0,n.useMemo)(function(){return new window.ResizeObserver(function(e){if(e[0]){var t=e[0].contentRect;o({x:t.x,y:t.y,width:t.width,height:t.height,top:t.top,left:t.left,bottom:t.bottom,right:t.right})}})},[]);return s(function(){if(t)return u.observe(t),function(){u.disconnect()}},[t]),[a,i]}:function(){return[r.ZT,l]}}},function(e){e.O(0,[4881,7495,7622,9590,8410,4300,7661,6525,1037,7093,604,1744],function(){return e(e.s=32004)}),_N_E=e.O()}]);