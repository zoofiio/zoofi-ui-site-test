(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{32004:function(e,a,t){Promise.resolve().then(t.bind(t,10219))},10219:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return AdminPage}});var s=t(31113),n=t(99548),r=t(44939),l=t(73417),i=t(87031),o=t(19757),u=t(59175),c=t(15506),d=t(26361),p=t(64103),m=t(23125),b=t(83960),f=t(45631),x=t(58409),v=t(85665),g=t(62531),h=t(35057),y=t(33737),A=t(11292),j=t(41440);let w={menu:()=>(0,d.cn)("bg-white dark:bg-black dark:border"),option:e=>(0,d.cn)({"!bg-primary/50":e.isFocused,"!bg-primary":e.isSelected}),control:()=>"bg-white dark:bg-black !min-h-[58px] !border-primary/70 !shadow-none",singleValue:()=>"dark:text-white"},N="bg-white dark:bg-transparent border-primary/70 w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none ",C=[{label:"资产利息率",value:"Y"},{label:"目标AAR",value:"AART"},{label:"安全AAR",value:"AARS"},{label:"上顶AAR",value:"AARU"},{label:"熔断AAR",value:"AARC"},{label:"赎回手续费",value:"C"},{label:"进入国库比例",value:"TreasuryFeeRate"},{label:"Discount冷静时间",value:"CircuitBreakPeriod",units:0},{label:"低买池最小成交量USB",value:"PtyPoolMinUsbAmount"},{label:"高卖池最小成交量",value:"PtyPoolMinAssetAmount"},{label:"RateR",value:"RateR"}],S=[{label:"产品周期",value:"D",units:0},{label:"初始定价",value:"APRi"},{label:"保底定价",value:"APRl"},{label:"衰减时长",value:"T",units:0},{label:"价格变动系数",value:"e1",units:0},{label:"斜率变动系数",value:"e2",units:0},{label:"赎回手续费",value:"f1"},{label:"利息佣金",value:"f2"}];function Expandable(e){let{children:a,tit:t,disable:n}=e,[r,l]=(0,p.useState)(!1);return(0,s.jsxs)("div",{className:"flex flex-col w-full bg-white dark:bg-transparent rounded-lg overflow-hidden border border-solid border-primary/40",children:[(0,s.jsxs)("div",{className:"px-5 py-2 min-h-[58px] flex justify-between items-center text-sm",children:[(0,s.jsx)("div",{className:"font-medium text-base",children:t}),n?a:(0,s.jsxs)("div",{className:"px-2 py-1 rounded-full border border-solid border-primary flex items-center text-xs text-primary cursor-pointer ",onClick:()=>l(!r),children:[(0,s.jsx)("span",{className:"mr-[5px]",children:r?"Close":"Expand"}),r?(0,s.jsx)(b.iRh,{}):(0,s.jsx)(b.tv1,{})]})]}),(0,s.jsx)(m.Collapse,{isOpened:r,theme:{content:"bg-gray-200 dark:bg-transparent p-4 flex flex-col gap-2"},children:a})]})}function UpdateVaultParams(e){let{paramList:a,vault:t,protocoSettingAddress:r}=e,i=(0,p.useMemo)(()=>a.map(e=>({...e,label:"".concat(e.label,"(").concat(e.value,")")})),[a]),[{value:o,param:u},m]=(0,x.Z)({value:"",param:i[0]}),{data:b}=(0,c.uX)({contracts:a.map(e=>({abi:l.$4,address:r,functionName:"vaultParamValue",args:[t,(0,g.$G)(e.value,{size:32})]}))}),A=(0,p.useMemo)(()=>(b||[]).map((e,t)=>{let s=a[t];return"".concat(s.label,"(").concat(s.value,"): ").concat((0,h.b)(e.result||0n,"number"==typeof s.units?s.units:10))}),[b]),j="number"==typeof u.units?u.units:10,[C,S]=(0,v.Z)();return(0,s.jsxs)(Expandable,{tit:"Vault Param Vaule",children:[(0,s.jsx)(f.ZP,{classNames:w,maxMenuHeight:S.height+110,value:u,options:i,onChange:e=>m({param:e})}),(0,s.jsx)("input",{value:o.toString(),onChange:e=>{let a=(e.target.value||"").replaceAll("-","").replaceAll("+","");m({value:a})},type:"number",className:(0,d.cn)(N),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,s.jsx)(n.v,{tx:"Write",config:{abi:l.$4,address:r,functionName:"updateVaultParamValue",args:[t,(0,g.$G)(u.value,{size:32}),(0,y.v)(o,j)]},onTxSuccess:()=>{m({value:""})},className:"btn-primary w-full flex items-center justify-center gap-4"}),(0,s.jsx)("div",{className:"text-sm flex flex-col items-start",ref:C,children:A.map((e,a)=>(0,s.jsx)("div",{children:e},"info_".concat(a)))})]})}function UpdateVaultPrice(e){let{vc:a}=e,[{feed:t},r]=(0,x.Z)({feed:""});return(0,s.jsxs)(Expandable,{tit:"Vault Price Feed",children:[(0,s.jsx)("input",{type:"text",placeholder:"_assetTokenPriceFeed_",value:t,onChange:e=>r({feed:e.target.value}),className:(0,d.cn)(N)}),(0,s.jsx)(n.v,{tx:"Write",config:{abi:l.WW,address:a.vault,functionName:"updatePriceFeed",args:[t]},onTxSuccess:()=>{r({feed:""})},className:"btn-primary w-full flex items-center justify-center gap-4"})]})}let convertArgs=(e,a)=>e.map((e,t)=>{let s=a[t];return s.type.startsWith("uint")?BigInt(e):"bytes32"==s.type?(0,g.$G)(e,{size:32}):e});function GeneralAction(e){var a;let{abi:t,address:r,functionName:l,tit:i}=e,o=t.find(e=>"function"==e.type&&e.name==l),[{args:u},c]=(0,x.Z)({args:Array(o.inputs.length).fill("")});if(!o)return;let p=!o.inputs||0==o.inputs.length;return(0,s.jsxs)(Expandable,{tit:i||l,disable:p,children:[null===(a=o.inputs)||void 0===a?void 0:a.map((e,a)=>(0,s.jsx)("input",{type:"text",placeholder:e.name,value:u[a],onChange:e=>c({args:u.map((t,s)=>a==s?e.target.value:t)}),className:(0,d.cn)(N)},"input_".concat(a))),(0,s.jsx)(n.v,{tx:"Write",config:{abi:t,address:r,functionName:l,args:convertArgs(u,o.inputs)},className:(0,d.cn)("!mt-0 btn-primary flex items-center justify-center gap-4",p?"max-w-[100px]":"w-full")})]})}function ClaimYieldsForBuyPool(e){let{vc:a}=e,{data:t}=(0,c.D2)({abi:l.aT,address:a.ptyPoolBelowAddress,functionName:"claimableYields"}),r=a.ptyPoolBelowAddress&&t||0n,[{address:i},o]=(0,x.Z)({address:""});return(0,s.jsxs)(Expandable,{tit:"ClaimYields for Buy Low Pool",children:[(0,s.jsxs)("span",{children:["Yields: ",(0,A.d)(r)]}),(0,s.jsx)("input",{type:"text",placeholder:"recipient",value:i,onChange:e=>o({address:e.target.value}),className:(0,d.cn)(N)}),(0,s.jsx)(n.v,{tx:"Write",disabled:!a.ptyPoolBelowAddress||r<=0n,config:{abi:l.aT,address:a.ptyPoolBelowAddress,functionName:"claimYields",args:[i]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}function SetTester(e){let{vc:a}=e,{data:t}=(0,c.D2)({abi:l.Og,address:a.assetTokenFeed,functionName:"getTestersCount"}),{data:r}=(0,c.D2)({abi:l.Og,address:a.assetTokenFeed,functionName:"owner"}),i=t||0n,{data:o}=(0,c.uX)({contracts:Array.from(Array(parseInt(i.toString()))).map((e,t)=>({abi:l.Og,address:a.assetTokenFeed,functionName:"getTester",args:[BigInt(t)]}))}),u=(null==o?void 0:o.map(e=>e.result))||[],[{address:p},m]=(0,x.Z)({address:""});return(0,s.jsxs)(Expandable,{tit:"Set tester",children:[(0,s.jsxs)("div",{children:["Owner: ",r]}),(0,s.jsxs)("div",{children:["Tester Count: ",i.toString()]}),(0,s.jsx)("div",{children:"Testers"}),u.map(e=>(0,s.jsx)("div",{children:e},e)),(0,s.jsx)("input",{type:"text",placeholder:"recipient",value:p,onChange:e=>m({address:e.target.value}),className:(0,d.cn)(N)}),(0,s.jsx)(n.v,{tx:"Write",disabled:!p,config:{abi:l.Og,address:a.assetTokenFeed,functionName:"setTester",args:[p,!0]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}let k=[{label:"赎回手续费",value:"C"}];function AdminPage(){let e=(0,u.p)(),a=o.iK[e]||[],t=o.VQ[e]||[],n=i.Fw[e]||[],{chain:c}=(0,j.m)(),d=(0,p.useMemo)(()=>{let e=a.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"L-Vault"})),s=t.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"P-Vault"})),r=n.map(e=>({label:e.assetSymbol,value:e.vault,data:e,type:"B-Vault"}));return[...e,...s,...r].map(e=>({...e,label:"".concat(e.label,"(").concat(e.type,")")}))},[a,t,n]),[{current:m},b]=(0,x.Z)({current:d[0]});return(0,s.jsx)(r.E,{children:(0,s.jsx)("div",{className:"w-full flex",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 w-full max-w-[840px] mx-auto px-5",children:[(0,s.jsx)(f.ZP,{classNames:w,defaultValue:d[0],options:d,onChange:e=>e&&b({current:e})}),"L-Vault"==m.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:C,protocoSettingAddress:o.e_[e]}),(0,s.jsx)(UpdateVaultPrice,{vc:m.data}),["pauseMint","unpauseMint","pauseRedeem","unpauseRedeem","pauseUsbToMarginTokens","unpauseUsbToMarginTokens"].map(e=>(0,s.jsx)(GeneralAction,{functionName:e,abi:l.WW,address:m.data.vault},"l-vault-".concat(e))),(0,s.jsx)(GeneralAction,{abi:l.EF,functionName:"transferOwnership",address:o.Vq[e]}),(0,s.jsx)(ClaimYieldsForBuyPool,{vc:m.data}),(null==c?void 0:c.testnet)&&(0,s.jsx)(SetTester,{vc:m.data})]}),"P-Vault"==m.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:k,protocoSettingAddress:o.e_[e]}),["configureBlastYieldsAndGas","configureBlastPoints"].map(e=>(0,s.jsx)(GeneralAction,{abi:l.a4,functionName:e,address:m.data.vault},"p-vault-".concat(e)))]}),"B-Vault"==m.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:S,protocoSettingAddress:m.data.protocolSettingsAddress}),["pauseDeposit","unpauseDeposit","pauseSwap","unpauseSwap","pauseClaimBribes","unpauseClaimBribes","updateStakingPool","rescueFromStakingPool"].map(e=>(0,s.jsx)(GeneralAction,{abi:l.j5,functionName:e,address:m.data.vault},"b-vault-".concat(e))),(0,s.jsx)(GeneralAction,{tit:"transferOwnership",abi:l.RR,functionName:"transferOwnership",address:m.data.protocolAddress})]})]})})})}},99548:function(e,a,t){"use strict";t.d(a,{v:function(){return ApproveAndTx}});var s=t(31113),n=t(19757),r=t(26361),l=t(64103),i=t(47259),o=t(58714),u=t(41440),c=t(41774),d=t(48914);let p={},useApproves=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:s,chainId:m}=(0,u.m)(),b=(0,c.t)(),{data:f}=(0,d.p)(),[x,v]=(0,l.useState)(!1),g=(0,l.useMemo)(()=>Object.keys(e).filter(e=>e!==n.K8),[e]),[h,y]=(0,l.useState)(a&&p[a]||{}),updateAllownce=(e,t)=>{a&&(p[a]={...p[a]||{},[e]:t},y(a=>({...a,[e]:t})))},A=(0,c.t)();(0,l.useEffect)(()=>{s&&a&&b&&m&&g.forEach(e=>{b.readContract({abi:o.Wo,address:e,functionName:"allowance",args:[s,a]}).then(a=>updateAllownce(e,a||0n)).catch(console.error)})},[g,m,s]);let[j,w]=(0,l.useState)(!1),N=(0,l.useMemo)(()=>g.filter(a=>(0,r.ok)(e,a)>0n&&(0,r.ok)(e,a)>(0,r.ok)(h,a)),[e,g,h]),approve=async()=>{if(0!=N.length&&a)try{w(!0),v(!1);for(let s=0;s<N.length;s++){let n=N[s],r=!1===t?e[n]:t,l=await (null==f?void 0:f.writeContract({abi:o.Wo,address:n,functionName:"approve",args:[a,r]}));l&&await (null==A?void 0:A.waitForTransactionReceipt({hash:l})),updateAllownce(n,r)}i.A.success("Approve success"),w(!1),v(!0)}catch(e){i.A.error((0,r.az)(e)),w(!1),v(!1)}};return{approve,loading:j,shouldApprove:N.length>0,isSuccess:x}};var m=t(78354),b=t(88501),f=t(36762);function ApproveAndTx(e){let{className:a,txType:t="btn-primary",tx:n,busyShowTxet:r=!0,approves:i,spender:o,requestAmount:u,config:c,toast:d=!0,disabled:p,onTxSuccess:x,onApproveSuccess:v}=e,{write:g,isDisabled:h,isLoading:y}=(0,m.R)(c,{onSuccess:()=>x&&x(),autoToast:d}),A=p||h||y||!1===c.enabled,{approve:j,shouldApprove:w,loading:N,isSuccess:C}=useApproves(i||{},o,u),S=(0,l.useRef)();return(S.current=v,(0,l.useEffect)(()=>{S.current&&C&&S.current()},[C]),w)?(0,s.jsxs)("button",{className:(0,b.m)(t,"flex items-center justify-center gap-4",a),onClick:j,disabled:p||!j||N,children:[N&&(0,s.jsx)(f.$,{}),"Approve"]}):(0,s.jsxs)("button",{className:(0,b.m)(t,"flex items-center justify-center gap-4",a),onClick:()=>g(),disabled:A,children:[y&&(0,s.jsx)(f.$,{}),(r||!y)&&n]})}},44939:function(e,a,t){"use strict";t.d(a,{E:function(){return PageWrap}});var s=t(31113);t(64103);var n=t(26361),r=t(69708),l=t(12045);function PageWrap(e){let{children:a,className:t}=e,i=(0,l.l)(e=>e.theme),o=(0,r.usePathname)();return(0,s.jsx)("div",{className:(0,n.cn)("min-h-[calc(100vh+1px)] h-auto pt-[90px] pb-6",t),style:{backgroundSize:"contain",background:"light"==i?"#eeeeee":"/"==o?"url(bg_home.svg) center bottom no-repeat,linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)":"linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)"},children:a})}},36762:function(e,a,t){"use strict";t.d(a,{$:function(){return Spinner}});var s=t(31113),n=t(33501);let Spinner=e=>{let{className:a}=e;return(0,s.jsxs)("svg",{fill:"none",className:(0,n.Z)(a,"animate-spin h-5 w-5 2-ml-1 2mr-3"),viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},87031:function(e,a,t){"use strict";t.d(a,{Fw:function(){return l}});var s=t(73216);let n="0x6763511669c0202dBC6396583a0bb70D481803F5",r="0xf65408DdB28c052ab593555361162067d66bE15F",l={[s.BG.id]:[{vault:"0xf13035cf330921D71C4c7120d3966400045429AC",asset:"0xdDEe6A193C33Af0E4641c80fAfAbD447C03fFf07",assetSymbol:"iRED",pToken:"0xc156ea7A76e0B4e10D355861450E6FEB658ace2a",pTokenSymbol:"piRED",yTokenSymbol:"yiRED",protocolAddress:n,protocolSettingsAddress:r},{vault:"0xb167b0D3118ba521C1c5C61011bD9Cb071a50bb3",asset:"0xD69ADb6FB5fD6D06E6ceEc5405D95A37F96E3b96",assetSymbol:"HONEY-USDC",pToken:"0xC71537F14a2577F14Aa1988a981fe575908E15C9",pTokenSymbol:"pHONEY-USDC",yTokenSymbol:"yHONEY-USDC",protocolAddress:n,protocolSettingsAddress:r}]}},78354:function(e,a,t){"use strict";t.d(a,{R:function(){return useWrapContractWrite}});var s=t(26361),n=t(64103),r=t(47259),l=t(41774),i=t(48914),o=t(15506);function useWrapContractWrite(e,a){let{autoToast:t=!0,onSuccess:u}=a||{},[c,d]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),b=(0,l.t)(),{data:f}=(0,i.p)(),x=!b||!f||!f.account||c||!e,v=(0,o.hp)(),write=async()=>{if(!x){d(!0),m(!1);try{let a="function"==typeof e?await e():e,{request:s}=await b.simulateContract({account:f.account,...a}),n=await f.writeContract(s),l=await b.waitForTransactionReceipt({hash:n});if("success"!==l.status)throw"Transaction reverted";m(!0),u&&u(),t&&r.A.success("Transaction success"),v.update()}catch(e){t&&r.A.error((0,s.az)(e))}d(!1)}};return{write,isDisabled:x,isLoading:c,isSuccess:p}}}},function(e){e.O(0,[4881,7495,7622,3119,8410,5631,8511,4138,7093,604,1744],function(){return e(e.s=32004)}),_N_E=e.O()}]);