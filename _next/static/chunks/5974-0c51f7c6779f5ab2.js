"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5974],{95702:function(e,t,a){a.d(t,{c:function(){return CoinIcon}});var n=a(31113),s=a(26758),o=a(26361);let r={BERA:"BERA.svg",balance:"balance.png",berachain:"berachain.svg",bg_home:"bg_home.svg",blackLine:"blackLine.svg",Bull:"Bull.svg",coin:"coin.png",discord:"discord.png",discount:"discount.png",ETH:"ETH.svg",ethfi:"ethfi.png",ETHx:"ETHx.svg",galxe:"galxe.png",gift:"gift.png",gold:"gold.png",greenCycle:"greenCycle.png",GreenDot:"GreenDot.svg","HONEY-USDC":"HONEY-USDC.svg","HONEY-WBERA":"HONEY-WBERA.webp","HONEY-WBTC":"HONEY-WBTC.svg","HONEY-WETH":"HONEY-WETH.svg",HONEY:"HONEY.svg",iBGT:"iBGT.webp",iRED:"iRED.svg","logo-alt":"logo-alt.svg",Panda:"Panda.svg",piRED:"piRED.svg","status-green":"status-green.svg","status-red":"status-red.svg",twitter:"twitter.png",USDC:"USDC.svg",USDCx:"USDCx.svg",USDT:"USDT.svg",Venom:"Venom.svg",WBERA:"WBERA.svg",WBTC:"WBTC.svg",WBTCx:"WBTCx.svg",weeth:"weeth.png",weETH:"weETH.svg",weETHx:"weETHx.svg",WETH:"WETH.svg",xBERA:"xBERA.svg",xiBGT:"xiBGT.svg",yiRED:"yiRED.svg",ZUSD:"ZUSD.svg"};function CoinIcon(e){let{symbol:t,size:a=48,url:l,...c}=e,u=r[t],i="".concat(s.G,"/").concat(u);return u||l?(0,n.jsx)("img",{...c,className:(0,o.cn)(c.className),width:a,height:a,src:u?i:l,alt:t}):(0,n.jsxs)("svg",{...c,width:a,height:a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("text",{className:"fill-primary/60",width:"20",x:"12",y:"12",textAnchor:"middle",fontSize:12,dominantBaseline:"middle",children:t.slice(0,2)}),(0,n.jsx)("circle",{className:"stroke-primary/60",cx:"12",cy:"12",r:"11.5",strokeWidth:1})]})}},68535:function(e,t,a){let n;a.d(t,{l6:function(){return getBvaultEpochYtPrices},_c:function(){return getBvaultsPtSynthetic}});var s=a(44769),o=a(83606);let instance=()=>(n&&n.defaults.baseURL==="https://beta-api.".concat(s.Kh.value)||(n=o.Z.create({baseURL:"https://beta-api.".concat(s.Kh.value),timeout:1e4,headers:{"Content-Type":"application/json"}})),n);var r={get:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let s=await instance().get(e,{...n,params:a});if(console.info("res:",null==s?void 0:s.data),(null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.code)!==200)throw s.data;return s.data.data},post:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let s=await instance().post(e,a,n);if((null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.code)!==200)throw s.data;return s.data.data}};let getBvaultEpochYtPrices=(e,t)=>r.get("/api/bvault/getEpochYTPrices/".concat(e,"/").concat(t)),getBvaultsPtSynthetic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.post("/api/bvault/batchGetEpochPtSynthetic",{bvaults:e})}},26758:function(e,t,a){a.d(t,{G:function(){return s}});var n=a(28070);let s=n.env.NEXT_PUBLIC_BASE_PATH||""},90168:function(e,t,a){a.d(t,{P:function(){return n}}),a(19757);let n={"0xD69ADb6FB5fD6D06E6ceEc5405D95A37F96E3b96":{poolType:36000n,base:"0x0e4aaf1351de4c0264c5c7056ef3777b41bd8e03",quote:"0xd6d83af58a19cd14ef3cf6fe848c9a4d21e5727c"},"0xd28d852cbcc68dcec922f6d5c7a8185dbaa104b7":{poolType:36000n,base:"0x0e4aaf1351de4c0264c5c7056ef3777b41bd8e03",quote:"0x7507c1dc16935b82698e4c63f2746a2fcf994df8"}}},18358:function(e,t,a){a.d(t,{R3:function(){return useUpBVaultForUserAction},Vw:function(){return useEpochesData},d6:function(){return useResetBVaultsData},gz:function(){return useCalcClaimable},lL:function(){return calcBVaultPTApy},nr:function(){return useBVault},oU:function(){return useBVaultApy},pg:function(){return calcBVaultBoost},v7:function(){return useBVaultBoost}});var n=a(22139),s=a(59175),o=a(26361),r=a(84944),l=a(83978),c=a.n(l),u=a(64103),i=a(96670),d=a(3106);function useResetBVaultsData(){let e=(0,s.p)(),{address:t}=(0,i.m)();(0,u.useEffect)(()=>{},[e]),(0,u.useEffect)(()=>{d.w.getState().sliceUserBVaults.reset()},[t])}function useBVault(e){return(0,d.o)(t=>t.sliceBVaultsStore.bvaults[e]||(0,o.Yb)({current:(0,o.Yb)({},0n)},0n),["sliceBVaultsStore.bvaults.".concat(e)])}function useEpochesData(e){let t=(0,d.o)(t=>{let a=t.sliceBVaultsStore.bvaults[e];if(!a||a.epochCount<=0n)return[];let n=c().range(1,parseInt((a.epochCount+1n).toString())).reverse(),s=t.sliceBVaultsStore.epoches;return n.map(t=>s["".concat(e,"_").concat(t)]).filter(e=>null!=e)},["sliceBVaultsStore.bvaults.".concat(e),"sliceBVaultsStore.epoches"]),a=(0,d.o)(t=>t.sliceUserBVaults.epoches[e]||[],["sliceUserBVaults.epoches.".concat(e)]);return(0,u.useMemo)(()=>{let e=a.reduce((e,t)=>({...e,[t.epochId.toString()]:t}),{});return t.map(t=>(0,o.Yb)({...t,...e[t.epochId.toString()]||{bribes:[]}},0n))},[t,a])}function useCalcClaimable(e){let t=useEpochesData(e);return(0,u.useMemo)(()=>{let e=t.filter(e=>e.claimableAssetBalance&&e.settled);return{ids:e.map(e=>e.epochId),claimable:e.reduce((e,t)=>e+t.claimableAssetBalance,0n)}},[t])}function calcBVaultBoost(e){let t=d.w.getState(),a=t.sliceBVaultsStore.bvaults[e],s=(null==a?void 0:a.current.vaultYTokenBalance)||0n,o=(null==a?void 0:a.Y)||0n,l=o>0n?s*n.Pq/o:0n,c=(null==a?void 0:a.current.yTokenAmountForSwapYT)||0n,u=(null==a?void 0:a.lockedAssetTotal)||0n,i=c>0n?u*n.Pq/c:0n;console.info("calcBootst:",(0,r.d)(l),(0,r.d)(i));let p=i*l/n.Pq;return p}function useBVaultBoost(e){let t=(0,d.o)(()=>calcBVaultBoost(e),["sliceBVaultsStore.bvaults.".concat(e)]);return[(0,r.d)(t,0),t]}function calcBVaultPTApy(e){let t=d.w.getState(),a=t.sliceBVaultsStore.bvaults[e],s=(0,o.ok)(t.sliceBVaultsStore.yTokenSythetic,[e]),r=a&&a.current.assetTotalSwapAmount&&s?a.current.assetTotalSwapAmount*n.SH*BigInt(1e10)/s:0n;return r}function useBVaultApy(e){let t=(0,d.o)(()=>calcBVaultPTApy(e),["sliceBVaultsStore.bvaults.".concat(e),"sliceBVaultsStore.yTokenSythetic.".concat(e)]);return[(0,o.Jh)(t,10),t]}function useUpBVaultForUserAction(e,t){let{address:a}=(0,i.m)();return()=>{(0,o.XD)(async()=>{if(null==t||t(),!a)return;await Promise.all([d.w.getState().sliceTokenStore.updateTokensBalance([e.asset,e.pToken],a),d.w.getState().sliceTokenStore.updateTokenTotalSupply([e.asset,e.pToken]),d.w.getState().sliceBVaultsStore.updateBvaults([e]),d.w.getState().sliceBVaultsStore.updateYTokenSythetic([e])]);let n=d.w.getState().sliceBVaultsStore.bvaults[e.vault];await d.w.getState().sliceBVaultsStore.updateEpoches(e,n.epochCount>1n?[n.epochCount,n.epochCount-1n]:[n.epochCount]);let s=[];for(let t=parseInt(n.epochCount.toString());t>0;t--){let a=d.w.getState().sliceBVaultsStore.epoches["".concat(e.vault,"_").concat(t)];s.push(a)}console.info("onUserAction:epoches",s),await d.w.getState().sliceUserBVaults.updateEpoches(e,a,s)},3,1e3)}}},3106:function(e,t,a){a.d(t,{w:function(){return S},o:function(){return useStore}});var n=a(83978),s=a.n(n),o=a(64103),r=a(93108),l=a(43794),c=a(70258),u=a(68535),i=a(78403),d=a(62531),p=a(22139),g=a(87031),f=a(73216),h=a(19757),v=a(90168),B=a(58714);let m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(a,n)=>s().mapValues(e,(e,s)=>e(e=>a({[s]:{...n()[s],...e}}),()=>n()[s],t[s]))}({sliceBVaultsStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateBvaults=async a=>{let n=(0,i.B)(),o=await Promise.all(a.map(e=>n.readContract({abi:c.Pe,address:e.bQueryAddres,functionName:"queryBVault",args:[e.vault]}).then(t=>({vault:e.vault,item:t})))),r=s().filter(o,e=>null!=e).reduce((e,t)=>({...e,[t.vault]:t.item}),{});return e({bvaults:{...t().bvaults,...r}}),r},updateEpoches=async(a,n)=>{var o;let r=n||s().range(1,parseInt((((null===(o=t().bvaults[a.vault])||void 0===o?void 0:o.epochCount)||0n)+1n).toString())).map(e=>BigInt(e));if(0==r.length)return{};let l=(0,i.B)(),u=await Promise.all(r.map(e=>l.readContract({abi:c.Pe,address:a.bQueryAddres,functionName:"queryBVaultEpoch",args:[a.vault,e]}))),d=u.reduce((e,t)=>({...e,["".concat(a.vault,"_").concat(t.epochId.toString())]:t}),{});return e({epoches:{...t().epoches,...d}}),d},updateYTokenSythetic=async a=>{let n=(null==a?void 0:a.map(e=>e.vault))||s().keys(t().bvaults),o=await (0,u._c)(n),r=s().mapValues(o,e=>BigInt(e));return e({yTokenSythetic:{...t().yTokenSythetic,...r}}),r};return{bvaults:{},epoches:{},yTokenSythetic:{},...a,updateBvaults,updateEpoches,updateYTokenSythetic}},sliceLVaultsStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateLVaults=async a=>{let n=(0,i.B)();if(0==a.length)return{};let s=await Promise.all(a.map(e=>Promise.all([n.readContract({abi:c.Wn,address:e.vaultQuery,functionName:e.isStable?"getStableVaultState":"getVaultState",args:[e.vault]}),n.readContract({abi:c.WW,address:e.vault,functionName:"assetBalance"}),n.readContract({abi:c.WW,address:e.vault,functionName:"usdTotalSupply"}),n.readContract({abi:c.WW,address:e.vault,functionName:"vaultMode"}),n.readContract({abi:c.WW,address:e.vault,functionName:"paramValue",args:[(0,d.$G)("Y",{size:32})]}),e.ptyPoolBelowAddress?n.readContract({abi:c.aT,address:e.ptyPoolBelowAddress,functionName:"totalStakingBalance"}):Promise.resolve(0n),e.ptyPoolAboveAddress?n.readContract({abi:c.aT,address:e.ptyPoolAboveAddress,functionName:"totalStakingBalance"}):Promise.resolve(0n),e.ptyPoolBelowAddress?n.getBalance({address:e.ptyPoolBelowAddress}):Promise.resolve(0n),n.readContract({abi:c.nq,address:e.assetTokenFeed,functionName:"latestPrice"}),n.readContract({abi:c.WW,address:e.vault,functionName:"paramValue",args:[(0,d.$G)("CircuitBreakPeriod",{size:32})]})]).then(t=>{let[a,n,s,o,r,l,c,u,i,d]=t,g=BigInt(Math.floor(new Date().getTime()/1e3)),f=e.isStable?a.M_USDCx>0n&&a.aar<a.AARS:2==o&&(a.aar>=a.AARC||g-a.AARBelowCircuitBreakerLineTime>d);return{...{...a,isStable:!!e.isStable},assetBalance:n,usbTotalSupply:s,vaultMode:e.isStable?a.aar<a.AARS&&a.M_USDC>0n?2:1:o,Y:r,buyPoolTotalStaking:l,sellPoolTotalStaking:c,buyPoolBalance:u,latestPrice:i*p.Pq/p.pn,CircuitBreakPeriod:d,discountEnable:f}}))),o=s.reduce((e,t,n)=>({...e,[a[n].vault]:t}),{});return e({lvaults:{...t().lvaults,...o}}),o},updateUserLVault=async(a,n)=>{let s=(0,i.B)();if(a.isStable)return;let[o,r,l,u,d,p,g]=await Promise.all([s.readContract({abi:c.aT,address:a.ptyPoolBelowAddress,functionName:"userStakingBalance",args:[n]}),s.readContract({abi:c.aT,address:a.ptyPoolBelowAddress,functionName:"earnedMatchedToken",args:[n]}),s.readContract({abi:c.aT,address:a.ptyPoolBelowAddress,functionName:"earnedStakingYields",args:[n]}).catch(()=>0n),s.readContract({abi:c.aT,address:a.ptyPoolBelowAddress,functionName:"earnedMatchingYields",args:[n]}),s.readContract({abi:c.aT,address:a.ptyPoolAboveAddress,functionName:"userStakingBalance",args:[n]}),s.readContract({abi:c.aT,address:a.ptyPoolAboveAddress,functionName:"earnedMatchedToken",args:[n]}),s.readContract({abi:c.aT,address:a.ptyPoolAboveAddress,functionName:"earnedMatchingYields",args:[n]})]),f={buyPool_userStakingBalance:o,buyPool_earnedMatchedToken:r,buyPool_earnedStakingYields:l,buyPool_earnedMatchingYields:u,sellPool_userStakingBalance:d,sellPool_earnedMatchedToken:p,sellPool_earnedMatchingYields:g};return e({user:{...t().user,[a.vault]:f}}),f};return{lvaults:{},user:{},...a,updateLVaults,updateUserLVault}},sliceTokenStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateTokenTotalSupply=async a=>{if(0==a.length)return{};let n=(0,i.B)(),s=await Promise.all(a.map(e=>e==h.K8?Promise.resolve(0n):n.readContract({abi:B.Wo,address:e,functionName:"totalSupply"}))),o=s.reduce((e,t,n)=>({...e,[a[n]]:t}),{});return e({totalSupply:{...t().totalSupply,...o}}),o},updateTokensBalance=async(a,n)=>{if(0==a.length)return{};let s=(0,i.B)(),o=await Promise.all(a.map(e=>e==h.K8?s.getBalance({address:n}):s.readContract({abi:B.Wo,address:e,functionName:"balanceOf",args:[n]}))),r=o.reduce((e,t,n)=>({...e,[a[n]]:t}),{});return e({balances:{...t().balances,...r}}),r},updateTokenPrices=async a=>{let n=(0,i.B)(),o=s().groupBy(a,e=>v.P[e]?"lp":"token"),r=o.lp||[];if(0!==r.length){console.info("mlps;",a,r);let s=await Promise.all(r.map(e=>Promise.all([n.readContract({abi:c.Mi,address:g._C[(0,f.BV)()],functionName:"queryPrice",args:[v.P[e].base,v.P[e].quote,BigInt(v.P[e].poolType)]}),n.readContract({abi:c.Mi,address:g._C[(0,f.BV)()],functionName:"queryLiquidity",args:[v.P[e].base,v.P[e].quote,BigInt(v.P[e].poolType)]})]))),o={[g.TE[(0,f.BV)()]]:p.Pq};r.forEach((e,t)=>{let a=v.P[e].base,n=v.P[e].quote,r=s[t][0],l="0xd6d83af58a19cd14ef3cf6fe848c9a4d21e5727c"==n?10n**6n:1n;o[e]=r/l**2n,o[n]=(r*10n**9n/(0x10000000000000000n*l))**2n*o[a]/p.Pq}),console.info("lpPrics:",o),e({prices:{...t().prices,...o}})}return{}},updateDefTokenList=async()=>{let t=await fetch("https://raw.githubusercontent.com/berachain/default-lists/main/src/tokens/bartio/defaultTokenList.json").then(e=>e.json()).then(e=>e.tokens.map(e=>({symbol:e.symbol,address:e.address,name:e.name,url:(e.logoURI||"").replace("https://https://","https://")})));return localStorage.setItem("catchedDefTokenList",JSON.stringify(t)),e({defTokenList:t}),t};return{totalSupply:{},updateTokenTotalSupply,balances:{},updateTokensBalance,prices:{},updateTokenPrices,defTokenList:(()=>{try{return JSON.parse(localStorage.getItem("catchedDefTokenList")||"[]")}catch(e){return[]}})(),updateDefTokenList,...a}},sliceUserBVaults:(e,t,a)=>{let updateEpoches=async(a,n,s)=>{let o=s.filter(e=>e.epochId>0n);if(0==o.length)return{};let r=(0,i.B)(),l=await Promise.all(o.map(e=>r.readContract({abi:c.Pe,address:a.bQueryAddres,functionName:"queryBVaultEpochUser",args:[a.vault,e.epochId,n]})));return e({epoches:{...t().epoches,[a.vault]:l}}),l};return{epoches:{},...a,updateEpoches,reset:()=>e({epoches:{}})}}},{}),b=(0,l.mW)(m,{name:"BoundStore",store:"BoundStore",enabled:!0}),S=(0,r.Ue)(b);function useStore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],a=S();return(0,o.useMemo)(()=>e(a),t.map(e=>e?s().get(a,e):a))}},84944:function(e,t,a){a.d(t,{d:function(){return displayBalance}});var n=a(35057);let displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18;if(!e)return"0";let fmtNumber=e=>e.toLocaleString("en-US",{maximumFractionDigits:t}),s=Number((0,n.b)(e,a)),o=Number((.1**t).toFixed(t));return s>0&&s<o?s<.001?fmtNumber(1e6*s)+"μ":"<"+o:s<0&&s>-o?"≈0":fmtNumber(s)}}}]);